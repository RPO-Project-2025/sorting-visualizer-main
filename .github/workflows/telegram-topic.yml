name: Telegram Topic Notifications

on:
  issues:
    types: [opened, closed]
  pull_request:
    types: [opened, closed, ready_for_review]

jobs:
  telegram-topic:
    runs-on: ubuntu-latest
    steps:
      - name: Send to Telegram topic
        run: |
          MESSAGE="ğŸ¯ *${{ github.repository }}*%0A%0A"
          
          {% raw %}
          if [ "${{ github.event_name }}" = "issues" ] && [ "${{ github.event.action }}" = "opened" ]; then
            MESSAGE="${MESSAGE}ğŸ“ *ĞĞ¾Ğ²Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°*: ${{ github.event.issue.title }}%0AğŸ‘¤ *ĞĞ²Ñ‚Ğ¾Ñ€*: ${{ github.event.issue.user.login }}%0AğŸ”— *Ğ¡ÑÑ‹Ğ»ĞºĞ°*: ${{ github.event.issue.html_url }}"
          elif [ "${{ github.event_name }}" = "issues" ] && [ "${{ github.event.action }}" = "closed" ]; then
            MESSAGE="${MESSAGE}âœ… *Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ°*: ${{ github.event.issue.title }}%0AğŸ‘¤ *Ğ—Ğ°ĞºÑ€Ñ‹Ğ»*: ${{ github.event.issue.user.login }}"
          elif [ "${{ github.event_name }}" = "pull_request" ] && [ "${{ github.event.action }}" = "opened" ]; then
            MESSAGE="${MESSAGE}ğŸ”€ *ĞĞ¾Ğ²Ñ‹Ğ¹ Pull Request*: ${{ github.event.pull_request.title }}%0AğŸ‘¤ *ĞĞ²Ñ‚Ğ¾Ñ€*: ${{ github.event.pull_request.user.login }}%0AğŸ”— *Ğ¡ÑÑ‹Ğ»ĞºĞ°*: ${{ github.event.pull_request.html_url }}"
          else
            MESSAGE="${MESSAGE}â„¹ï¸ *Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ*: ${{ github.event_name }} - ${{ github.event.action }}"
          fi
          {% endraw %}

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d "message_thread_id=2" \
            -d "text=$MESSAGE" \
            -d "parse_mode=Markdown"
